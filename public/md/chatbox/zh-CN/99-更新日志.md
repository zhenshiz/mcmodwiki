<h1 id="更新日志" data-toc-id="更新日志">更新日志</h1>
<h2 id="1" data-toc-id="1">1.1</h2>
<ul>
  <li>
    <p>更新内置的示例对话数据包</p>
  </li>
  <li>
    <p>移除对话框人名自带的[]</p>
  </li>
  <li>
    <p>优化命令和选项解锁命令的执行方法</p>
  </li>
  <li>
    <p>
      组件新增<code>hidden</code>（配合后者使用）和<code>renderEvents</code>字段（即可以直接在主题里定义组件渲染事件）
    </p>
  </li>
  <li>
    <p>立绘相关：</p>
    <ul>
      <li>
        <p>现在对话框、选项、按键都是立绘的子类，也就是都可以添加动画和渲染附件</p>
      </li>
      <li>
        <p>立绘可以设置鼠标悬浮纹理</p>
      </li>
      <li>
        <p>渲染附件可以通过动画改变</p>
      </li>
      <li>
        <p>渲染附件新增文本类型</p>
      </li>
      <li>
        <p>对话文件中替换立绘新增<code>replace</code>字段，用于移除其他同id的立绘</p>
      </li>
    </ul>
  </li>
  <li>
    <p>调试功能优化，可以调整更多参数，支持用快捷键重载数据包</p>
  </li>
  <li>
    <p>
      新增了两个内置的组件渲染事件类型（<code>PLAY_ANIMATION</code>和<code>RESTART_ANIMATION</code>）
    </p>
  </li>
  <li>
    <p>选项的<code>next</code>字段如果填<code>this</code>，则不会进行跳转（对应的组件渲染事件也是）</p>
  </li>
  <li>
    <p>
      <span data-type="hidden-text">兼容 Placeholder API 插件（测试环境为 Arclight fabric 混合端，如有需要请联系作者获取，但应该几乎不会有人用吧）</span>
    </p>
  </li>
</ul>
<h2 id="109" data-toc-id="109">1.0.9</h2>
<ul>
  <li>
    <p>对话可以添加多个目标实体，便于在对话中与实体互动和调用数据；</p>
  </li>
  <li>
    <p>添加与对话目标实体数据相关的占位符，可在对话文本和指令中解析成对应的数据，详见占位符</p>
  </li>
  <li>
    <p>对话json：</p>
    <ul>
      <li>
        <p>部分组件新增<code>renderEvents</code>字段，详见对话组件渲染事件</p>
      </li>
      <li>
        <p>新增<code>animationFPS</code>字段，用于限制立绘动画的帧率，默认值为60</p>
      </li>
      <li>
        <p>
          新增<code>autoPlayTick</code>字段，用于调整自动跳转下一句对话的延迟，默认值为20（对于有音效的对话，跳转延迟不会大于20）
        </p>
      </li>
      <li>
        <p>
          选项的隐藏和锁定改为由<code>unlockCommand</code>和<code>isLock</code>参数控制，根据<code>execute if</code>或<code>execute unless</code>指令的执行结果判断是否隐藏或锁定
        </p>
      </li>
      <li>
        <p>移除了部分字段，现在对话json中的文本都使用翻译键</p>
      </li>
    </ul>
  </li>
  <li>
    <p>主题中对话框配置项新增<code>textAlign</code>字段，即支持居中对齐和右对齐</p>
  </li>
  <li>
    <p>
      <code>SkipChatEvent</code>改为双端事件，便于在服务端修改对话<span data-type="hidden-text">（因为双端，所以chatBoxScreen参数又没了，哦悲悲）</span>。关闭对话界面也会触发<code>SkipChatEvent</code>事件，此时<code>index</code>参数为-1
    </p>
  </li>
  <li>
    <p>渲染调整：</p>
    <ul>
      <li>
        <p>选项的位置现在会根据<code>alignY</code>参数自动调整，优化选项文本对齐的方式</p>
      </li>
      <li>
        <p>立绘现在以图像的中心为基准进行缩放，而不是左上角</p>
      </li>
    </ul>
  </li>
  <li>
    <p>添加简单的对话调试功能，在对话框screen按F3进入</p>
  </li>
  <li>
    <p>添加文本注音标签，详见占位符</p>
  </li>
  <li>
    <p><code>ChatBoxUtil</code>增加更多方法，便于使用kubejs动态修改对话</p>
  </li>
</ul>
<h3 id="破坏性修改提示" data-toc-id="破坏性修改提示">破坏性修改提示</h3>
<ul>
  <li>
    <p>由于优化了选项文本对齐的方式，新版选项的文字可能错位，请修改主题文件中选项的<code>optionChatX</code>参数</p>
  </li>
  <li>
    <p>由于立绘缩放方式改为以图像中心为基准，因此缩放的立绘可能错位，请调整立绘的坐标参数（推荐使用调试模式）</p>
  </li>
  <li>
    <p><code>SkipChatEvent</code>改为双端事件，该事件的参数也有改变</p>
  </li>
  <li>
    <p>
      选项点击事件（ChatOptionClickEvent）已完全改头换面为对话组件渲染事件（ComponentEvent），因此kubejs工具类中相应的方法由<code>registerClickEvent</code>改为<code>registerComponentEvent</code>，且参数有变化
    </p>
  </li>
  <li>
    <p>由于选项的隐藏和锁定改为由指令控制，因此旧的计分板相关的参数已完全移除（虽然应该没人用，但还是提一句）</p>
  </li>
</ul>
<h2 id="108" data-toc-id="108">1.0.8</h2>
<ul>
  <li>
    <p>
      <code>chatbox</code>指令新增<code>command</code>子命令，可以通过指令进入下一句话、开关自动对话的功能以及更改对话框是屏幕(screen)还是渲染层(render)（同时移除了相应的配置项）
    </p>
  </li>
  <li>
    <p>render模式下，按键提示的<code>visible</code>若为<code>false</code>会同时取消按键的监听</p>
  </li>
  <li>
    <p>添加泰拉生物的兼容，允许替换泰拉生物的对话框</p>
  </li>
  <li>
    <p>screen模式下添加右键隐藏对话框功能</p>
  </li>
  <li>
    <p>添加调整对话框文本显示速度的配置项</p>
  </li>
  <li>
    <p>
      添加立绘控制系统，可以继承上一句对话的立绘，并且可以选择删除部分立绘（添加<code>clearOldPortrait</code>和<code>removePortrait</code>参数）
    </p>
  </li>
  <li>
    <p>可以将多个图片组合在一起，成为一个立绘（立绘部分添加<code>attachment</code>参数）</p>
  </li>
  <li>
    <p>为立绘及其动画添加旋转角度参数</p>
  </li>
  <li>
    <p>立绘动画添加坐标偏移量参数（<code>xOffset</code>和<code>yOffset</code>）以支持立绘相对运动</p>
  </li>
  <li>
    <p>主题文件新增<code>customAnimation</code>字段用于预设立绘动画，便于立绘使用</p>
  </li>
</ul>
<h2 id="107" data-toc-id="107">1.0.7</h2>
<ul>
  <li>
    <p>新增配置项：下句话如果没有新音效，是否中断前面正在播放的音效</p>
  </li>
  <li>
    <p>修复第一次打开对话框直接崩溃的Bug</p>
  </li>
  <li>
    <p>修复<code>isHistoricalSkip</code>的默认值为<code>true</code></p>
  </li>
  <li>
    <p>修复数据包最大访问次数的优先级过于高导致指令无法调试的bug</p>
  </li>
  <li>
    <p>修复数据包文件太大导致发包异常的bug</p>
  </li>
  <li>
    <p>取消位置的限制，大小的最大限制</p>
  </li>
  <li>
    <p>将主题中大部分数字都支持小数</p>
  </li>
  <li>
    <p>进入对话框，点击选项执行指令支持多条指令</p>
  </li>
  <li>
    <p>对话json中添加<code>theme</code>字段，可以在进入对话时自动绑定主题</p>
  </li>
  <li>
    <p>动画支持修改图片材质</p>
  </li>
  <li>
    <p>对话立绘支持临时修改参数</p>
  </li>
  <li>
    <p>支持视频</p>
  </li>
  <li>
    <p>更新render模式对话框</p>
  </li>
  <li>
    <p>修复一个对话中不能出现多个不同id的玩家的头像的bug</p>
  </li>
</ul>
<h2 id="106" data-toc-id="106">1.0.6</h2>
<ul>
  <li>
    <p>修复了对话框文本为1个字符的时候，游戏会崩溃的Bug</p>
  </li>
  <li>
    <p>修复了背景图片不会因为跳转其它对话自动清除的Bug</p>
  </li>
  <li>
    <p>更新案例数据包</p>
  </li>
</ul>
<h2 id="105" data-toc-id="105">1.0.5</h2>
<ul>
  <li>
    <p>历史记录跳转后保留的记录更加合理</p>
  </li>
  <li>
    <p>添加参数限制一段话是否可以通过历史记录界面回溯</p>
  </li>
  <li>
    <p>一句对话中添加一个<code>backgroundImage</code>参数可以设置背景图片</p>
  </li>
  <li>
    <p>支持KubeJS样式的事件</p>
  </li>
  <li>
    <p>修复对话框只会获取最后一个对话里的<code>isTranslatable</code>等参数的Bug</p>
  </li>
  <li>
    <p>新增<code>maxTriggerCount</code>参数设置一段对话的最大访问次数</p>
  </li>
  <li>
    <p>新增进度触发器，可以通过进度为条件来打开对话框</p>
  </li>
  <li>
    <p>新增指令<code>/chatbox maxTriggerCount</code>修改和重置最大访问次数</p>
  </li>
</ul>
<h2 id="104" data-toc-id="104">1.0.4</h2>
<ul>
  <li>
    <p>修复ftb执行指令打不开对话框的bug</p>
  </li>
  <li>
    <p>无权限玩家无法执行点击选项时应该触发的指令</p>
  </li>
  <li>
    <p>在对话框内滚轮下滑跳转剧情，上滑打开历史记录界面。历史记录页面右键关闭</p>
  </li>
</ul>
<h2 id="103" data-toc-id="103">1.0.3</h2>
<ul>
  <li>
    <p>在进入每句话的时候都可以选择执行一条指令</p>
  </li>
  <li>
    <p>自定义动画参数中<code>x、y、scale、opacity</code>都不再为必填项</p>
  </li>
  <li>
    <p>为KubeJS提供了全局变量<code>ChatBoxUtil</code>，包括服务端调用和客户端调用的两套api</p>
  </li>
  <li>
    <p>将翻译键参数独立出来，只需要在对话文件中配置一次即可（应该不会有人一会用翻译键一会用硬编码的吧）</p>
  </li>
  <li>
    <p>当前对话是否是否能被esc关闭（默认能），是否允许玩家单机打开对话框的时候被时停（默认单机时停，多人正常）</p>
  </li>
  <li>
    <p>
      在玩家输入<code>/reload</code>后会自动按照玩家上次切换的主题样式更新玩家当前主题的样式，不再需要每次修改主题样式的参数还需要先切换主题指令来刷新当前的样式
    </p>
  </li>
  <li>
    <p>修复服务端运行失败以及服务端无法显示选项的bug</p>
  </li>
  <li>
    <p><code>chatbox skip</code>的组名参数也支持补全</p>
  </li>
</ul>
<h2 id="102" data-toc-id="102">1.0.2</h2>
<ul>
  <li>
    <p>修复<code>/chatbox skip</code>指令跳转默认值没效果的bug</p>
  </li>
  <li>
    <p>给<code>SkipChatEvent</code>事件添加一个<code>chatBoxScreen</code>参数</p>
  </li>
  <li>
    <p>对话框主题的立绘配置中每一项都需添加<code>type</code>属性</p>
  </li>
  <li>
    <p>对话框文本的配置中关于立绘的配置改为字符串数组，不再需要<code>type</code>和<code>value</code></p>
  </li>
  <li>
    <p>立绘所有的类型都支持使用透明度和自定义动画，图片额外支持3种预设的动画</p>
  </li>
  <li>
    <p>进入对话会关闭之前播放的音乐</p>
  </li>
</ul>
<p></p>